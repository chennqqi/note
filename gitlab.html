<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303244 (zh-CN, DDL); Windows/6.3.9600 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="350"/>

<div>
<span><div><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">环境</h3><h5 style="padding: 0px; margin: 1.5em 0px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-family: 'Source Sans Pro', sans-serif; color: rgb(75, 75, 75); font-size: 12px; background-color: rgb(255, 255, 255);">Requirements</h5><table style="padding: 0px; margin: 0px 0px 20px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; border-collapse: collapse; border-spacing: 0px; max-width: 100%; border-style: solid; border-color: silver; word-break: break-word; color: rgb(75, 75, 75); font-family: 'Source Sans Pro', sans-serif; font-size: 13px; background-color: rgb(255, 255, 255);"><thead style="padding: 0px; margin: 0px; box-sizing: border-box;"><tr style="padding: 0px; margin: 0px; box-sizing: border-box;"><th align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; vertical-align: bottom; border-style: solid; border-color: silver; border-collapse: collapse;">软件</th><th align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; vertical-align: bottom; border-style: solid; border-color: silver; border-collapse: collapse;">版本</th></tr></thead><tbody style="padding: 0px; margin: 0px; box-sizing: border-box;"><tr style="padding: 0px; margin: 0px; box-sizing: border-box;"><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">CentOS</td><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">6.6</td></tr><tr style="padding: 0px; margin: 0px; box-sizing: border-box;"><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">Python</td><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">2.6</td></tr><tr style="padding: 0px; margin: 0px; box-sizing: border-box;"><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">Ruby</td><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">2.1.5</td></tr><tr style="padding: 0px; margin: 0px; box-sizing: border-box;"><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">Git</td><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">1.7.10+</td></tr><tr style="padding: 0px; margin: 0px; box-sizing: border-box;"><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">Redis</td><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">2.0+</td></tr><tr style="padding: 0px; margin: 0px; box-sizing: border-box;"><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">MySQL</td><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;"> </td></tr><tr style="padding: 0px; margin: 0px; box-sizing: border-box;"><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">GitLab</td><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">7-8-stable</td></tr><tr style="padding: 0px; margin: 0px; box-sizing: border-box;"><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">GitLab Shell</td><td align="left" style="padding: 3px; margin: 0px; box-sizing: border-box; font-size: 12px; color: rgb(69, 69, 69); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; vertical-align: top; border-style: solid; border-color: silver; border-collapse: collapse;">v2.6.0</td></tr></tbody></table><h5 style="padding: 0px; margin: 1.5em 0px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-family: 'Source Sans Pro', sans-serif; color: rgb(75, 75, 75); font-size: 12px; background-color: rgb(255, 255, 255);">yum源</h5><p style="padding: 0px; margin: 10px auto; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; color: rgb(75, 75, 75); font-family: 'Source Sans Pro', sans-serif; font-size: 13px; background-color: rgb(255, 255, 255);">为了提高软件安装速度，将yum源设置为阿里云开源镜像</p><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);"><span style="padding: 0px; margin: 0px; box-sizing: border-box;">$ </span>cd /etc/yum.repos.d
<span style="padding: 0px; margin: 0px; box-sizing: border-box;">$ </span>wget -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">O</span> <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">CentOS</span>-<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">Base</span>.repo <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">http:</span>/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/mirrors.aliyun.com/repo</span><span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/Centos-6.repo</span></code></pre><h5 style="padding: 0px; margin: 1.5em 0px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-family: 'Source Sans Pro', sans-serif; color: rgb(75, 75, 75); font-size: 12px; background-color: rgb(255, 255, 255);">必要软件包</h5><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">$ yum -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">y</span> install libicu-devel patch gcc-<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">c</span>++ readline-devel zlib-devel libffi-devel openssl-devel <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">make</span> autoconf automake libtool bison libxml2-devel libxslt-devel libyaml-devel zlib-devel openssl-devel cpio expat-devel gettext-devel curl-devel <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">perl</span>-ExtUtils-CBuilder <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">perl</span>-ExtUtils-MakeMaker</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">安装Git</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">// 查看当前git版本
$ git --<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">version</span>

// 如果小于<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">1.7</span>.<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">10</span>则先卸载
$ yum <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">remove</span> git

// 下载最新的git并安装
$ wget -O git-src.zip http<span style="padding: 0px; margin: 0px; box-sizing: border-box;">s:</span>//github.<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">com</span>/git/git/archive/master.zip
$ unzip git-src.zip
$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">cd</span> git-src
$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">make</span> prefix=/usr/local <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">all</span>
$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">make</span> prefix=/usr/local install
$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">ln</span> -fs /usr/local/bin/git* /usr/bin/</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">安装Ruby环境</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">$ mkdir /tmp/ruby &amp;&amp; cd /tmp/ruby
$ curl <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);">--progress ftp://ftp.ruby-lang.org/pub/ruby/ruby-2.1.5.tar.gz | tar xz</span>
$ cd ruby-2.1.5
$ ./configure <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);">--disable-install-rdoc</span>
$ make &amp;&amp; make <span style="padding: 0px; margin: 0px; box-sizing: border-box;"><span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">install</span>

$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">ln</span> -s /usr/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">local</span>/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">bin</span>/ruby /usr/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">bin</span>/ruby
$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">ln</span> -s /usr/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">local</span>/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">bin</span>/gem /usr/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">bin</span>/gem
$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">ln</span> -s /usr/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">local</span>/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">bin</span>/bundle /usr/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">bin</span>/bundle

// 设置ruby gem源为淘宝
$ gem source -r https://rubygems.org/
$ gem source -a http://ruby.taobao.org/

$ gem <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">install</span> bundler <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);">--no-ri --no-rdoc</span></span></code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">安装MySQL及初始化GitLab库</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">$ yum install mysql mysql-devel mysql-server -y
$ /etc/init.d/mysqld start
$ chkconfig mysqld <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">on</span>

<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);">// 登录mysql创建gitab的帐号和数据库</span>
mysql&gt; <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">CREATE</span> USER <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">'gitlab'</span>@<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">'localhost'</span> IDENTIFIED <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">BY</span> <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">'gitlab'</span>;
mysql&gt; <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">CREATE</span> DATABASE <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">IF</span> <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">NOT</span> EXISTS `gitlabhq_production` <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">DEFAULT</span> CHARACTER <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">SET</span> `utf8` COLLATE `utf8_unicode_ci`;
mysql&gt; GRANT <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">SELECT</span>, INSERT, UPDATE, DELETE, <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">CREATE</span>, DROP, <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">INDEX</span>, ALTER <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">ON</span> `gitlabhq_production`.* <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">TO</span> <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">'gitlab'</span>@<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">'localhost'</span>;

<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);">//测试是否可以用git帐号登录数据库</span>
sudo -u git -H mysql -u gitlab -p -D gitlabhq_production</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">安装Redis</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);"><span style="padding: 0px; margin: 0px; box-sizing: border-box;">$ </span>yum -y install redis
<span style="padding: 0px; margin: 0px; box-sizing: border-box;">$ </span>/etc/init.d/redis start
<span style="padding: 0px; margin: 0px; box-sizing: border-box;">$ </span>chkconfig redis on</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">添加git帐号并允许sudo</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);"><span style="padding: 0px; margin: 0px; box-sizing: border-box;">$ </span>useradd --comment <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 255);">'GitLab'</span> git
<span style="padding: 0px; margin: 0px; box-sizing: border-box;">$ </span>echo <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 255);">&quot;git ALL=(ALL)       NOPASSWD: ALL&quot;</span> &gt;&gt;<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/etc/sudoers</span></code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">安装GitLab</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);"><span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>/home/git
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo -u git -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">H</span> git clone <span style="padding: 0px; margin: 0px; box-sizing: border-box;">https:</span>//gitlab.com/gitlab-org/gitlab-ce.git -b <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">7</span>-<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">8</span>-stable gitlab
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>cd /home/git/gitlab
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo -u git -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">H</span> cp config/gitlab.yml.example config/gitlab.yml

// 编辑git路径, gitlab的<span style="padding: 0px; margin: 0px; box-sizing: border-box;">host:</span>port
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>vim config/gitlab.yml
// <span style="padding: 0px; margin: 0px; box-sizing: border-box;">bin_path:</span> /usr/local/bin/git
// <span style="padding: 0px; margin: 0px; box-sizing: border-box;">host:</span> localhost
// <span style="padding: 0px; margin: 0px; box-sizing: border-box;">port:</span> <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">80</span> 

// 给文件夹添加相应的权限
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>chown -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">R</span> git log/
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>chown -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">R</span> git tmp/
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>chmod -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">R</span> u+rwX  log/
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>chmod -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">R</span> u+rwX  tmp/

// 创建必要的文件夹，以及复制配置文件
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo -u git -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">H</span> mkdir /home/git/gitlab-satellites
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo -u git -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">H</span> mkdir tmp/pids/
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo -u git -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">H</span> mkdir tmp/sockets/
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo chmod -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">R</span> u+rwX  tmp/pids/
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo chmod -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">R</span> u+rwX  tmp/sockets/
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo -u git -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">H</span> mkdir public/uploads
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo chmod -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">R</span> u+rwX  public/uploads
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo -u git -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">H</span> cp config/unicorn.rb.example config/unicorn.rb
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo -u git -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">H</span> cp config/initializers/rack_attack.rb.example
 config/initializers/rack_attack.rb

// 配置数据库连接信息
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo -u git cp config/database.yml.mysql config/database.yml
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>sudo -u git -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0); font-weight: bold;">H</span> vim  config/database.yml
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">$ </span>vim config/database.yml
// <span style="padding: 0px; margin: 0px; box-sizing: border-box;">production:</span>
//     <span style="padding: 0px; margin: 0px; box-sizing: border-box;">username:</span> gitlab
//     <span style="padding: 0px; margin: 0px; box-sizing: border-box;">password:</span> <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);">&quot;gitlab&quot;</span></code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">安装GitLab-Shell</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">cd</span> /home/git
$ sudo -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">u</span> git -H git clone http<span style="padding: 0px; margin: 0px; box-sizing: border-box;">s:</span>//gitlab.<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">com</span>/gitlab-org/gitlab-<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">shell</span>.git -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">b</span> v2.<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">6.0</span>
$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">cd</span> gitlab-<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">shell</span>/
$ sudo -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">u</span> git -H <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">cp</span> config.yml.example config.yml

// 编辑配置文件, 设置gitlab_url, redis-cli, <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">log</span>-level...
$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">vim</span> config.yml
// gitlab_ur<span style="padding: 0px; margin: 0px; box-sizing: border-box;">l:</span> <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">&quot;http://localhost/&quot;</span>
// /usr/bin/redis-cli

// 安装git-<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">shell</span>
$ sudo -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">u</span> git -H ./bin/install</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">安装需要ruby的gems</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">cd</span> /home/git/gitlab
$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">sudo</span> -u git -H bundle install --deployment --without development test postgres aws</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">初始化数据库(创建GitLab相关表)</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">sudo</span> -u git -H bundle <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">exec</span> rake gitlab:setup RAILS_ENV=production</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">安装启动文件以及日志切割文件</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">cp lib<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/support/i</span>nit.d<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/gitlab /</span>etc<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/init.d/gi</span>tlab
cp lib<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/support/i</span>nit.d<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/gitlab.default.example /</span>etc<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/default/gi</span>tlab
cp lib<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/support/</span>logrotate<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/gitlab /</span>etc<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/logrotate.d/gi</span>tlab</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">设置git帐号信息</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">$ sudo -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">u</span> git -H git config --<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">global</span> user.name <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">&quot;Troy Zhang&quot;</span>
$ sudo -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">u</span> git -H git config --<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">global</span> user.email <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">&quot;troyz@synnex.com&quot;</span>
$ sudo -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">u</span> git -H git config --<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">global</span> core.autocrlf <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">input</span></code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">安装Nginx</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">$ yum -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">y</span> install nginx
$ vim /etc/nginx/nginx.conf
user              root git;
worker_processes  <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">2</span>;
pid        /var/run/nginx.pid;

events {
    worker_connections  <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">1024</span>;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">'$remote_addr - $remote_user [$time_local] &quot;$request&quot; '</span>
                      <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">'$status $body_bytes_sent &quot;$http_referer&quot; '</span>
                      <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">'&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;'</span>;
<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># GITLAB</span><span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># Maintainer: @randx</span><span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># App Version: 5.0</span>

upstream gitlab {
  server unix:<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/home/git</span><span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/gitlab/tmp</span><span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">/sockets/gitlab</span>.<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">socket</span>;
}

server {
  <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">listen</span> *:<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">80</span> default_server;         <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># e.g., listen 192.168.1.1:80; In most cases *:80 is a good idea</span>
  server_name YOUR_SERVER_FQDN;     <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># e.g., server_name source.example.com;</span>
  server_tokens off;     <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># don't show the version number, a security best practice</span>
  root /home/git/gitlab/public;

  <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># Set value of client_max_body_size to at least the value of git.max_size in gitlab.yml</span>
  client_max_body_size <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">5</span><span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">m</span>;

  <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># individual nginx logs for this gitlab vhost</span>
  access_log  /var/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">log</span>/nginx/gitlab_access.<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">log</span>;
  error_log   /var/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">log</span>/nginx/gitlab_error.<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">log</span>;

  location / {
    <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># serve static files from defined root folder;.</span>
    <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># @gitlab is a named location for the upstream fallback, see below</span>
    try_files <span style="padding: 0px; margin: 0px; box-sizing: border-box;">$uri</span> <span style="padding: 0px; margin: 0px; box-sizing: border-box;">$uri</span>/<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">index</span>.html <span style="padding: 0px; margin: 0px; box-sizing: border-box;">$uri</span>.html <span style="padding: 0px; margin: 0px; box-sizing: border-box;">@gitlab</span>;
  }

  <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># if a file, which is not found in the root folder is requested,</span>
  <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># then the proxy pass the request to the upsteam (gitlab unicorn)</span>
  location <span style="padding: 0px; margin: 0px; box-sizing: border-box;">@gitlab</span> {
    proxy_read_timeout <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">300</span>; <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># https://github.com/gitlabhq/gitlabhq/issues/694</span>
    proxy_connect_timeout <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">300</span>; <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 136, 136);"># https://github.com/gitlabhq/gitlabhq/issues/694</span>
    proxy_redirect     off;

    proxy_set_header   X-Forwarded-Proto <span style="padding: 0px; margin: 0px; box-sizing: border-box;">$scheme</span>;
    proxy_set_header   Host              <span style="padding: 0px; margin: 0px; box-sizing: border-box;">$http_host</span>;
    proxy_set_header   X-Real-IP         <span style="padding: 0px; margin: 0px; box-sizing: border-box;">$remote_addr</span>;
    proxy_set_header   X-Forwarded-For   <span style="padding: 0px; margin: 0px; box-sizing: border-box;">$proxy_add_x_forwarded_for</span>;

    proxy_pass http:<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 136, 0);">//gitlab</span>;
  }
}
}</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">更改权限，启动nginx</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);"><span style="padding: 0px; margin: 0px; box-sizing: border-box;">$ </span>nginx -t
<span style="padding: 0px; margin: 0px; box-sizing: border-box;">$ </span>chown -<span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">R</span> <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(136, 0, 0);">git:</span>git /var/lib/nginx/
<span style="padding: 0px; margin: 0px; box-sizing: border-box;">$ </span>/etc/init.d/nginx start</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">检测当前环境</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);"><span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">sudo</span> -u git -H bundle <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">exec</span> rake gitlab:env:info RAILS_ENV=production</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">拉取gitlab静态资源文件</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">sudo</span> -u git -H bundle <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">exec</span> rake assets:precompile RAILS_ENV=production</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">启动gitlab</h3><pre style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; word-break: break-word; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);"><span style="padding: 0px; margin: 0px; box-sizing: border-box;">$ </span>/etc/init.d/gitlab start</code></pre><h3 style="padding: 0px; margin: 1.5em 0px 10px; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; font-size: 16px; color: rgb(102, 102, 102); font-family: Verdana; background-image: none; background-color: rgb(255, 255, 255); background-repeat: no-repeat;">检测各个组件是否正常工作</h3><div style="padding: 10px 20px; margin: 10px 0px; font-family: 'Source Code Pro', monospace; font-size: 0.9em; width: 673.188px; overflow: auto; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; box-sizing: border-box; border: 0px; border-radius: 5px; background: rgb(248, 248, 248);"><code style="padding: 5px !important; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 0); display: block; overflow-x: auto; font-family: 'Courier New', sans-serif !important; border-radius: 3px !important; border: 1px solid rgb(204, 204, 204) !important; background: rgb(255, 255, 255);">$ <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">sudo</span> -u git -H bundle <span style="padding: 0px; margin: 0px; box-sizing: border-box; color: rgb(0, 0, 255); font-weight: bold;">exec</span> rake gitlab:check RAILS_ENV=production</code></div></div></span>
</div></body></html> 